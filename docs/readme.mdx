---
name: Rifm
---

# RIFM - React Input Format & Mask

Is a tiny (â‰ˆ 650-750b) component to transform any input component
into formatted or masked input.

import { Playground, PropsTable } from 'docz';
import { Value } from 'react-powerplug';
import StringMask from 'string-mask';
import { Rifm } from '../src';
import {
  numberFormat,
  negNumberFormat,
  currencyFormat,
  currencyFormat2,
  dateFormat,
  dateFormatSym,
  formatPhone,
} from './format';
import TextField from '@material-ui/core/TextField';
import { css } from 'emotion';
import { injectGlobal } from 'emotion/macro';
import { EmbedCodesandbox } from './helpers.js';

<div
  data-run={(() => {
    injectGlobal(`
    .react-prism {
      overflow-x: auto;
    }
  `);
  })()}
/>

## Case enforcement

<EmbedCodesandbox
  title="istarkob/rifm: case-enforcement"
  href='github/istarkov/rifm/tree/master/codesandboxes/pages/case-enforcement'
/>

## Number format

Note: to prevent parseInt overflow you can use `maxLength` on input field
or write your own numberFormat.

<EmbedCodesandbox
  title="istarkob/rifm: number-format"
  href='github/istarkov/rifm/tree/master/codesandboxes/pages/number-format'
/>

## Material UI

It can work with 3rd party Inputs without pain

<Playground>
  <Value initial={''}>
    {text => (
      <Rifm
        accept={/[\d.]/gi}
        value={text.value}
        onChange={text.set}
        format={currencyFormat}
      >
        {({ value, onChange }) => (
          <TextField
            value={value}
            label={'Float'}
            onChange={onChange}
            className={css({ input: { textAlign: 'right' } })}
            type="tel"
          />
        )}
      </Rifm>
    )}
  </Value>
</Playground>

## Masked date input

Mask mostly the same as format, the difference that at some moment
when you enter symbols replace operation used instead of insert
for example when field value reached maximum length

Use `replace` to inform field to use replace operation

<Playground>
  <Value initial={'18-08-1978'}>
    {text => (
      <Rifm
        replace={v => v.length >= 10}
        value={text.value}
        onChange={text.set}
        format={dateFormat}
      >
        {({ value, onChange }) => (
          <>
            Date{' '}
            <input
              placeholder="dd-mm-yyyy"
              value={value}
              onChange={onChange}
              type="tel"
            />
          </>
        )}
      </Rifm>
    )}
  </Value>
</Playground>

## Masked date input 2

<Playground>
  <Value initial={''}>
    {text => (
      <Rifm
        replace={v => v.substr(9, 10) !== '_'}
        accept={/[\d_]/gi}
        value={text.value}
        onChange={text.set}
        format={dateFormatSym}
      >
        {({ value, onChange }) => (
          <>
            Date{' '}
            <input
              placeholder="__-__-____"
              value={value}
              onChange={onChange}
              type="tel"
            />
          </>
        )}
      </Rifm>
    )}
  </Value>
</Playground>

## String-mask input

Example of usage with [string-mask](https://github.com/the-darc/string-mask)

<Playground>
  <Value initial={''}>
    {v => (
      <Rifm
        replace={v => v.length >= 10}
        value={v.value}
        onChange={v.set}
        format={str => {
          const mask = new StringMask('0000-0000-0000-0000');
          const r = str.replace(/[^\d]+/gi, '');
          return mask.apply(r);
        }}
      >
        {({ value, onChange }) => <input onChange={onChange} value={value} />}
      </Rifm>
    )}
  </Value>
</Playground>

if replace attribute is defined input will try to skip refused symbols when reached,
like in 2 examples above it skips '-' symbols.
Or example below. Possibly this need additional prop for simplicity

## Masked Phone Input

Example of usage with
[libphonenumber-js](https://github.com/catamphetamine/libphonenumber-js) formatter

<Playground>
  <Value initial={''}>
    {text => (
      <Rifm
        // do not jump after ) until see number before
        replace={text.value.length < 6 && (/[^\d]+/).test(text.value[3]) ? undefined : v => v.length >= 14}
        value={text.value}
        onChange={text.set}
        format={formatPhone}
      >
        {({ value, onChange }) => (
          <>
            Phone{' '}+1{' '}
            <input  value={value} onChange={onChange} type="tel"/>
          </>
        )}
      </Rifm>
    )}

  </Value>
</Playground>

## React async ready

Check that it will work with new async React [see strict-mode](https://reactjs.org/docs/strict-mode.html)

### Format Async Ready

<Playground>
  <React.StrictMode>
    <Value initial={''}>
      {text => (
        <Rifm
          accept={/[\d.]/g}
          value={text.value}
          onChange={text.set}
          format={currencyFormat}
        >
          {({ value, onChange }) => (
            <>
              Format{' '}
              <input
                value={value}
                onChange={onChange}
                className={css({ textAlign: 'right' })}
                type="tel"
              />
            </>
          )}
        </Rifm>
      )}
    </Value>
  </React.StrictMode>
</Playground>

### Mask Async Ready

<Playground>
  <React.StrictMode>
    <Value initial={'18-08-1978'}>
      {text => (
        <Rifm
          replace={v => v.length >= 10}
          value={text.value}
          onChange={text.set}
          format={dateFormat}
        >
          {({ value, onChange }) => (
            <>
              Parse{' '}
              <input
                placeholder="dd-mm-yyyy"
                value={value}
                onChange={onChange}
                type="tel"
              />
            </>
          )}
        </Rifm>
      )}
    </Value>
  </React.StrictMode>
</Playground>
